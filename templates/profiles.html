<!doctype html>
<html data-theme="coffee">
  <head>
    <title>Profiles</title>
    <link rel="stylesheet" href="/templates/output.css" />
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
  </head>

  <body>
    <div class="flex flex-col min-h-screen bg-base-200 p-3">
      {{template "nav" .}}
      <main class="flex-1 flex flex-col gap-3 overflow-auto">
        <div
          class="card bg-base-100 shadow-lg p-4 m-0 flex flex-row items-center gap-2 flex-nowrap"
        >
          <form
            action="/add_profile"
            method="post"
            class="flex items-center gap-2 flex-1"
          >
            <textarea
              name="profile_name"
              placeholder="Enter profile name"
              rows="2"
              class="textarea textarea-bordered h-16 w-64"
              aria-label="Enter profile name"
            ></textarea>
            <textarea
              name="profile_description"
              placeholder="Enter profile description"
              rows="2"
              class="textarea textarea-bordered h-16 w-96"
              aria-label="Enter profile description"
            ></textarea>
            <button type="submit" class="btn btn-primary btn-xs">Add</button>
          </form>
        </div>

        <div
          class="card bg-base-100 shadow-lg p-4 m-0 flex flex-row items-center justify-between gap-3 flex-nowrap"
        >
          <form
            action="/profiles"
            method="get"
            class="flex items-center gap-2 flex-1"
          >
            <input
              type="text"
              name="search_query"
              id="search_query"
              value="{{.SearchQuery}}"
              placeholder="Search profiles..."
              class="input input-bordered w-full max-w-[320px]"
              aria-label="Search profiles"
            />
            <button type="submit" class="btn btn-primary btn-xs">Search</button>
          </form>
          <h1 class="text-base font-semibold">Profiles</h1>
        </div>

        <ul id="profile-list" class="flex flex-col gap-3">
          {{if .Profiles}} {{range $index, $profile := .Profiles}} {{if or (eq
          $.SearchQuery "") (contains (tolower $profile.Name) (tolower
          $.SearchQuery)) (contains (tolower $profile.Description) (tolower
          $.SearchQuery))}}
          <li class="card bg-base-100 shadow-lg p-3">
            <div class="flex items-center justify-between w-full gap-3">
              <h3 class="flex-shrink-0 mr-2.5 text-sm font-semibold">
                {{inc $index}}.
              </h3>
              <div class="flex items-center flex-1 mr-2.5 gap-2">
                <span
                  class="badge badge-success badge-outline whitespace-nowrap"
                  >{{$profile.Name}}</span
                >
                <div class="text-sm flex-1">{{$profile.Description}}</div>
              </div>
              <div class="flex flex-shrink-0 gap-1.5 ml-2.5">
                <button
                  class="btn btn-ghost"
                  onclick="copyProfileDescription('{{$profile.Description}}')"
                  title="Copy profile description to clipboard"
                  aria-label="Copy profile description"
                >
                  üìã
                </button>
                <a
                  class="btn btn-ghost"
                  href="/edit_profile?index={{$index}}"
                  title="Edit this profile"
                  aria-label="Edit profile"
                  >‚úèÔ∏è</a
                >
                <a
                  class="btn btn-ghost"
                  href="/delete_profile?index={{$index}}"
                  title="Delete this profile"
                  aria-label="Delete profile"
                  >üóëÔ∏è</a
                >
              </div>
            </div>
          </li>
          {{end}} {{end}} {{else}}
          <p class="text-center text-base-content/60">No profiles available.</p>
          {{end}}
        </ul>

        <div
          class="card bg-base-100 shadow-lg p-4 m-0 flex flex-row items-center justify-between gap-3 flex-nowrap"
        >
          <h2 class="text-sm font-semibold flex-shrink-0">Manage Profiles</h2>
          <form action="/reset_profiles" method="get">
            <input
              type="submit"
              value="Reset Profiles"
              class="btn btn-primary btn-xs"
            />
          </form>
        </div>

        <div class="fixed left-4 bottom-4 flex flex-col gap-2 z-[1000]">
          <button class="btn btn-info" onclick="scrollToTop()">‚Üë</button>
          <button class="btn btn-info" onclick="scrollToBottom()">‚Üì</button>
        </div>
      </main>
    </div>
    <script>
      function scrollToTop() {
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function scrollToBottom() {
        const footerHeight = 0; // No footer height calculation needed with DaisyUI
        const scrollHeight =
          document.body.scrollHeight - window.innerHeight - footerHeight;
        window.scrollTo({
          top: scrollHeight,
          behavior: "smooth",
        });
      }

      function copyProfileDescription(text) {
        navigator.clipboard.writeText(text).then(
          function () {
            console.log("Async: Copying to clipboard was successful!");
          },
          function (err) {
            console.error("Async: Could not copy text: ", err);
          },
        );
      }
    </script>
  </body>
</html>
