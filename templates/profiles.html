<!doctype html>
<html>
  <head>
    <title>Profiles</title>
    <link rel="stylesheet" href="/templates/output.css" />
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
  </head>

  <body>
    <div class="arena-shell">
      {{template "nav" .}}
      <main class="arena-main">
    <div class="glass-panel-enhanced p-4 m-0 sticky-header">
      <div class="flex-grow-1 text-left flex items-center">
        <h2 class="text-sm tracking-wide text-text/88">Add Profile</h2>
      </div>
      <div class="flex items-center justify-center flex-1">
        <form
          action="/add_profile"
          method="post"
          class="flex items-center flex-wrap gap-3"
        >
          <textarea
            name="profile_name"
            placeholder="Enter profile name"
            rows="2"
            class="input-enhanced w-56 min-w-[224px] h-16 resize-y"
            aria-label="Enter profile name"
          ></textarea>
          <textarea
            name="profile_description"
            placeholder="Enter profile description"
            rows="2"
            class="input-enhanced w-56 min-w-[224px] h-16 resize-y"
            aria-label="Enter profile description"
          ></textarea>
          <input type="submit" value="Add" class="btn-enhanced" />
        </form>
      </div>
      <div class="flex-grow-1 text-right flex items-center justify-end">
        &nbsp;
      </div>
    </div>
    <div class="glass-panel p-4 m-0 title-row">
      <div class="filter-container search-container">
        <form action="/profiles" method="get" class="search-form flex items-center gap-2" style="margin-left: 0px">
          <input
            type="text"
            name="search_query"
            id="search_query"
            value="{{.SearchQuery}}"
            placeholder="Search profiles..."
            class="input-enhanced w-80 max-w-full"
            aria-label="Search profiles"
          />
          <input type="submit" value="Search" class="btn-enhanced" />
        </form>
      </div>
      <div class="title-container justify-center">
        <h1 class="text-base tracking-wide">Profiles</h1>
      </div>
      <div class="search-container">&nbsp;</div>
    </div>
    <ul id="profile-list" class="flex flex-col gap-3">
      {{if .Profiles}} {{range $index, $profile := .Profiles}} {{if or (eq
      $.SearchQuery "") (contains (tolower $profile.Name) (tolower $.SearchQuery)) (contains (tolower $profile.Description) (tolower $.SearchQuery))}}
      <li class="glass-panel p-3 m-0">
        <div class="flex items-center justify-between w-full gap-3">
          <h3 class="flex-shrink-0 mr-2.5 text-sm font-semibold">
            {{inc $index}}.
          </h3>
          <div class="flex items-center flex-1 mr-2.5 gap-2">
            <span class="inline-block px-2 py-0.5 rounded text-xs font-medium bg-green-20 text-green-400 whitespace-nowrap">{{$profile.Name}}</span>
            <div class="text-sm flex-1">{{$profile.Description}}</div>
          </div>
          <div class="profile-actions flex-shrink-0 flex gap-1.5 ml-2.5">
            <button
              class="btn-icon action-button copy-button"
              onclick="copyProfileDescription('{{$profile.Description}}')"
              title="Copy profile description to clipboard"
              aria-label="Copy profile description"
            >
              üìã
            </button>
            <a
              class="btn-icon action-button edit-button"
              href="/edit_profile?index={{$index}}"
              title="Edit this profile"
              aria-label="Edit profile"
            >‚úèÔ∏è</a
            >
            <a
              class="btn-icon action-button delete-button"
              href="/delete_profile?index={{$index}}"
              title="Delete this profile"
              aria-label="Delete profile"
            >üóëÔ∏è</a
            >
          </div>
        </div>
      </li>
      {{end}} {{end}} {{else}}
      <p class="text-center text-text-muted">No profiles available.</p>
      {{end}}
    </ul>
    <div class="glass-panel p-4 m-0 sticky-footer">
      <div class="flex items-center gap-3 flex-wrap">
        <h2 class="text-sm tracking-wide text-text/88">Manage Profiles</h2>
        <form action="/reset_profiles" method="get">
          <input type="submit" value="Reset Profiles" class="btn-enhanced" />
        </form>
      </div>
    </div>
    <div class="scroll-buttons">
      <button class="btn-enhanced scroll-button" onclick="scrollToTop()">‚Üë</button>
      <button class="btn-enhanced scroll-button" onclick="scrollToBottom()">‚Üì</button>
    </div>
    <script>
      function scrollToTop() {
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function scrollToBottom() {
        const footerHeight =
          document.querySelector(".sticky-footer").offsetHeight;
        const scrollHeight =
          document.body.scrollHeight - window.innerHeight - footerHeight;
        window.scrollTo({
          top: scrollHeight,
          behavior: "smooth",
        });
      }

      function copyProfileDescription(text) {
        navigator.clipboard.writeText(text).then(
          function () {
            console.log("Async: Copying to clipboard was successful!");
          },
          function (err) {
            console.error("Async: Could not copy text: ", err);
          }
        );
      }
    </script>
      </main>
    </div>
  </body>
</html>
